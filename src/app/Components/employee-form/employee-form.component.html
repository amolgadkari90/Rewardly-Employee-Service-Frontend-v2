<div class="form-container">
  <h2 *ngIf="!isEditMode">Create Employee</h2>
  <h2 *ngIf="isEditMode">Update Employee</h2>

  <!-- Success / Error Alerts -->
  <div
    *ngIf="apiSuccessMessage"
    class="alert alert-success"
    role="alert"
    aria-live="polite"
  >
    <svg
      class="alert-icon"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
      />
    </svg>
    <span>{{ apiSuccessMessage }}</span>
  </div>

  <div
    *ngIf="apiGeneralError"
    class="alert alert-error"
    role="alert"
    aria-live="assertive"
  >
    <svg
      class="alert-icon"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
      />
    </svg>
    <span>{{ apiGeneralError }}</span>
  </div>

  <!-- Skeleton Loading when in Edit Mode and loading data -->
  <div *ngIf="loading" class="skeleton-form">
    <div class="skeleton-title"></div>
    <div class="skeleton-input"></div>
    <div class="skeleton-input"></div>
    <div class="skeleton-input"></div>
    <div class="skeleton-input"></div>
    <div class="skeleton-input"></div>
    <div class="skeleton-buttons">
      <div class="skeleton-btn"></div>
      <div class="skeleton-btn"></div>
    </div>
  </div>

  <!-- Actual Form (shown when not loading) -->
  <form
    *ngIf="!loading"
    [formGroup]="employeeForm"
    (ngSubmit)="submitForm()"
    class="modern-form"
    novalidate
  >
    <!-- Name -->
    <div class="form-group">
      <div class="input-wrapper">
        <input
          id="empName"
          type="text"
          formControlName="empName"
          placeholder=" "
          class="floating-input"
          autocomplete="name"
          aria-describedby="empName-error"
        />
        <label for="empName" class="floating-label">Name</label>
      </div>
      <div
        id="empName-error"
        class="field-error"
        *ngIf="form['empName'].touched && form['empName'].invalid"
      >
        <div *ngIf="form['empName'].errors?.['required']">
          Name is required!
        </div>
        <div *ngIf="form['empName'].errors?.['minlength']">
          Name must be at least 2 characters!
        </div>
        <div *ngIf="form['empName'].errors?.['maxlength']">
          Name must be less than 100 characters!
        </div>
        <div *ngIf="form['empName'].errors?.['apiError']">
          {{ form['empName'].errors?.['apiError'] }}
        </div>
      </div>
    </div>

    <!-- Designation - Dropdown -->
    <div class="form-group">
      <div class="input-wrapper select-wrapper">
        <select
          id="empDesignation"
          formControlName="empDesignation"
          class="floating-select"
          aria-describedby="empDesignation-error"
        >
          <option value="" disabled>Select Designation</option>
          <option value="Software Engineer">Software Engineer</option>
          <option value="Senior Software Engineer">
            Senior Software Engineer
          </option>
          <option value="Technical Lead">Technical Lead</option>
          <option value="Project Manager">Project Manager</option>
          <option value="System Analyst">System Analyst</option>
          <option value="QA Engineer">QA Engineer</option>
          <option value="DevOps Engineer">DevOps Engineer</option>
          <option value="UI/UX Designer">UI/UX Designer</option>
          <option value="Data Scientist">Data Scientist</option>
        </select>
        <label for="empDesignation" class="floating-label">Designation</label>
        <svg
          class="select-arrow"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
        >
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </div>
      <div
        id="empDesignation-error"
        class="field-error"
        *ngIf="form['empDesignation'].touched && form['empDesignation'].invalid"
      >
        <div *ngIf="form['empDesignation'].errors?.['required']">
          Designation is required!
        </div>
      </div>
    </div>

    <!-- Salary -->
    <div class="form-group">
      <div class="input-wrapper">
        <input
          id="empSalary"
          type="number"
          formControlName="empSalary"
          placeholder=" "
          class="floating-input"
          min="0"
          step="0.01"
          aria-describedby="empSalary-error"
        />
        <label for="empSalary" class="floating-label">Salary (â‚¹)</label>
      </div>
      <div
        id="empSalary-error"
        class="field-error"
        *ngIf="form['empSalary'].touched && form['empSalary'].invalid"
      >
        <div *ngIf="form['empSalary'].errors?.['required']">
          Salary is required!
        </div>
        <div *ngIf="form['empSalary'].errors?.['min']">
          Salary must be positive!
        </div>
        <div *ngIf="form['empSalary'].errors?.['apiError']">
          {{ form['empSalary'].errors?.['apiError'] }}
        </div>
      </div>
    </div>

    <!-- Experience Years -->
    <div class="form-group">
      <div class="input-wrapper">
        <input
          id="empExperienceYears"
          type="number"
          formControlName="empExperienceYears"
          placeholder=" "
          class="floating-input"
          min="0"
          max="50"
          aria-describedby="empExperienceYears-error"
        />
        <label for="empExperienceYears" class="floating-label"
          >Experience (Years)</label
        >
      </div>
      <div
        id="empExperienceYears-error"
        class="field-error"
        *ngIf="
          form['empExperienceYears'].touched &&
          form['empExperienceYears'].invalid
        "
      >
        <div *ngIf="form['empExperienceYears'].errors?.['required']">
          Experience is required!
        </div>
        <div *ngIf="form['empExperienceYears'].errors?.['min']">
          Experience must be at least 0!
        </div>
        <div *ngIf="form['empExperienceYears'].errors?.['max']">
          Experience must not exceed 50 years!
        </div>
      </div>
    </div>

    <!-- Performance Rating -->
    <div class="form-group">
      <div class="input-wrapper">
        <input
          id="empPerformanceRating"
          type="number"
          formControlName="empPerformanceRating"
          placeholder=" "
          class="floating-input"
          min="1"
          max="5"
          step="0.1"
          aria-describedby="empPerformanceRating-error"
        />
        <label for="empPerformanceRating" class="floating-label"
          >Performance Rating (1-5)</label
        >
      </div>
      <div
        id="empPerformanceRating-error"
        class="field-error"
        *ngIf="
          form['empPerformanceRating'].touched &&
          form['empPerformanceRating'].invalid
        "
      >
        <div *ngIf="form['empPerformanceRating'].errors?.['required']">
          Performance rating is required!
        </div>
        <div *ngIf="form['empPerformanceRating'].errors?.['min']">
          Rating must be at least 1!
        </div>
        <div *ngIf="form['empPerformanceRating'].errors?.['max']">
          Rating must not exceed 5!
        </div>
      </div>
    </div>

    <!-- Buttons -->
    <div class="button-row">
      <button type="button" routerLink="/employees" class="btn btn-outline">
        Cancel
      </button>
      <button
        type="submit"
        [disabled]="submitting || employeeForm.invalid"
        class="btn btn-primary"
      >
        <span *ngIf="submitting" class="spinner" aria-hidden="true"></span>
        <span class="btn-text">
          {{
            submitting
              ? isEditMode
                ? "Updating..."
                : "Saving..."
              : isEditMode
              ? "Update"
              : "Save"
          }}
        </span>
      </button>
    </div>
  </form>
</div>